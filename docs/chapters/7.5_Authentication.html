
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>7.5 Authentication 身份认证 · Laravel - 从百草园到三味书屋</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="original Taylor Otwell, translate zgldh">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="7.6_IoC_Based_Extension.html" />
    
    
    <link rel="prev" href="7.4_Session.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Author's_Note.html">
            
                <a href="Author's_Note.html">
            
                    
                    Author's Note 作者自序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    1 Dependency Injection 依赖注入
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="1.1_The_Problem.html">
            
                <a href="1.1_The_Problem.html">
            
                    
                    1.1 The Problem 遇到的问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="1.2_Build_A_Contract.html">
            
                <a href="1.2_Build_A_Contract.html">
            
                    
                    1.2 Build A Contract 建立约定
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="1.3_Take_It_further.html">
            
                <a href="1.3_Take_It_further.html">
            
                    
                    1.3 Take It further 更进一步
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="1.4_Too_Much_Java.html">
            
                <a href="1.4_Too_Much_Java.html">
            
                    
                    1.4 Too Much Java? 太像Java了？
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    2 The IoC Container 控制反转容器
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="2.1_Basic_Binding.html">
            
                <a href="2.1_Basic_Binding.html">
            
                    
                    2.1 Basic Binding 基础绑定
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="2.2_Reflective_Resolution.html">
            
                <a href="2.2_Reflective_Resolution.html">
            
                    
                    2.2 Reflective Resolution 反射解决方案
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    3 Interface As Contract 接口约定
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="3.1_Strong_Typing_&_Water_Fowl.html">
            
                <a href="3.1_Strong_Typing_&_Water_Fowl.html">
            
                    
                    3.1 Strong Typing & Water Fowl 强类型和小鸭子
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="3.2_A_Contract_Example.html">
            
                <a href="3.2_A_Contract_Example.html">
            
                    
                    3.2 A Contract Example 约定的范例
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="3.3_Interface_&_Team_Development.html">
            
                <a href="3.3_Interface_&_Team_Development.html">
            
                    
                    3.3 Interface & Team Development 接口与团队开发
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    4 Service Provider 服务提供者
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="4.1_As_Bootstrapper.html">
            
                <a href="4.1_As_Bootstrapper.html">
            
                    
                    4.1 As Bootstrapper 他是引导程序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="4.2_As_Organizer.html">
            
                <a href="4.2_As_Organizer.html">
            
                    
                    4.2 As Organizer 作为管理工具
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="4.3_Booting_Providers.html">
            
                <a href="4.3_Booting_Providers.html">
            
                    
                    4.3 Booting Providers 服务提供者的启动过程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="4.4_Providing_The_Core.html">
            
                <a href="4.4_Providing_The_Core.html">
            
                    
                    4.4 Providing The Core 核心也是服务提供者的模式
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    5 Application Structure 应用结构
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="5.1_Introduction.html">
            
                <a href="5.1_Introduction.html">
            
                    
                    5.1 Introduction 介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="5.2_MVC_Is_Killing_You.html">
            
                <a href="5.2_MVC_Is_Killing_You.html">
            
                    
                    5.2 MVC Is Killing You MVC是慢性谋杀
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="5.3_Bye_Models.html">
            
                <a href="5.3_Bye_Models.html">
            
                    
                    5.3 Bye, Bye Models 再见，模型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="5.4_It's_All_About_The_Layers.html">
            
                <a href="5.4_It's_All_About_The_Layers.html">
            
                    
                    5.4 It's All About The Layers 核心思想就是分层
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="5.5_Where_To_Put_Stuff.html">
            
                <a href="5.5_Where_To_Put_Stuff.html">
            
                    
                    5.5 Where To Put "Stuff" 东西都放哪儿？
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    6 Applied Architecture: Decoupling Handles 实用做法：解耦处理函数
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="6.1_Introduction.html">
            
                <a href="6.1_Introduction.html">
            
                    
                    6.1 Introduction 介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="6.2_Decoupling_Handlers.html">
            
                <a href="6.2_Decoupling_Handlers.html">
            
                    
                    6.2 Decoupling Handlers 解耦处理函数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="6.3_Other_Handlers.html">
            
                <a href="6.3_Other_Handlers.html">
            
                    
                    6.3 Other Handlers 其他处理函数
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" >
            
                <span>
            
                    
                    7 Extending The Framework 扩展框架
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="7.1_Introduction.html">
            
                <a href="7.1_Introduction.html">
            
                    
                    7.1 Introduction 介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="7.2_Managers_&_Factories.html">
            
                <a href="7.2_Managers_&_Factories.html">
            
                    
                    7.2 Managers & Factories 管理者和工厂
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="7.3_Cache.html">
            
                <a href="7.3_Cache.html">
            
                    
                    7.3 Cache 缓存
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="7.4_Session.html">
            
                <a href="7.4_Session.html">
            
                    
                    7.4 Session 会话
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.9.5" data-path="7.5_Authentication.html">
            
                <a href="7.5_Authentication.html">
            
                    
                    7.5 Authentication 身份认证
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="7.6_IoC_Based_Extension.html">
            
                <a href="7.6_IoC_Based_Extension.html">
            
                    
                    7.6 IoC Based Extension 使用容器进行扩展
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="7.7_Request_Extension.html">
            
                <a href="7.7_Request_Extension.html">
            
                    
                    7.7 Request Extension 请求的扩展
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" >
            
                <span>
            
                    
                    8 Single Responsibility Principle 单一职责原则
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="8.1_Introduction.html">
            
                <a href="8.1_Introduction.html">
            
                    
                    8.1 Introduction 介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="8.2_In_Action.html">
            
                <a href="8.2_In_Action.html">
            
                    
                    8.2 In Action 实践
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" >
            
                <span>
            
                    
                    9 Open Closed Principle 开放封闭原则
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="9.1_Introduction.html">
            
                <a href="9.1_Introduction.html">
            
                    
                    9.1 Introduction 介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="9.2_In_Action.html">
            
                <a href="9.2_In_Action.html">
            
                    
                    9.2 In Action 实践
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" >
            
                <span>
            
                    
                    10 Liskov Substitution Principle 里氏替换原则
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="10.1_Introduction.html">
            
                <a href="10.1_Introduction.html">
            
                    
                    10.1 Introduction 介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="10.2_In_Action.html">
            
                <a href="10.2_In_Action.html">
            
                    
                    10.2 In Action 实践
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" >
            
                <span>
            
                    
                    11 Interface Segregation Principle 接口隔离原则
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="11.1_Introduction.html">
            
                <a href="11.1_Introduction.html">
            
                    
                    11.1 Introduction 介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="11.2_In_Action.html">
            
                <a href="11.2_In_Action.html">
            
                    
                    11.2 In Action 实践
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" >
            
                <span>
            
                    
                    12 Dependency Inversion Principle 依赖反转原则
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="12.1_Introduction.html">
            
                <a href="12.1_Introduction.html">
            
                    
                    12.1 Introduction 介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="12.2_In_Action.html">
            
                <a href="12.2_In_Action.html">
            
                    
                    12.2 In Action 实践
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >7.5 Authentication 身份认证</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="authentication-&#x8EAB;&#x4EFD;&#x8BA4;&#x8BC1;">Authentication &#x8EAB;&#x4EFD;&#x8BA4;&#x8BC1;</h1>
<p>Authentication may be extended the same way as the cache and session facilities. Again, we will use the extend method we have become familiar with:</p>
<p>&#x8EAB;&#x4EFD;&#x8BA4;&#x8BC1;&#x6A21;&#x5757;&#x7684;&#x6269;&#x5C55;&#x65B9;&#x5F0F;&#x548C;&#x7F13;&#x5B58;&#x4E0E;&#x4F1A;&#x8BDD;&#x7684;&#x6269;&#x5C55;&#x65B9;&#x5F0F;&#x4E00;&#x6837;&#xFF1A;&#x4F7F;&#x7528;&#x6211;&#x4EEC;&#x719F;&#x6089;&#x7684; extend &#x65B9;&#x6CD5;&#x5C31;&#x53EF;&#x4EE5;&#x8FDB;&#x884C;&#x6269;&#x5C55;&#xFF1A;</p>
<pre><code class="lang-php">Auth::extend(<span class="hljs-string">&apos;riak&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($app)</span>
</span>{
    <span class="hljs-comment">// Return implementation of Illuminate\Auth\UserProviderInterface</span>
});
</code></pre>
<p>The UserProviderInterface implementations are only responsible for fetching a UserInterface implementation out of persistent storage system, such as MySQL, Riak, etc. These two interfaces allow the Laravel authentication mechanisms to continue functioning regardless of how the user data is stored or what type of class is used to represent it.</p>
<p>&#x63A5;&#x53E3; UserProviderInterface &#x8D1F;&#x8D23;&#x4ECE;&#x5404;&#x79CD;&#x6301;&#x4E45;&#x5316;&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;&#x2014;&#x2014;&#x5982; MySQL&#xFF0C;Riak &#x7B49;&#x2014;&#x2014;&#x4E2D;&#x83B7;&#x53D6;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x5F97;&#x5230;&#x63A5;&#x53E3; UserInterface &#x7684;&#x5B9E;&#x73B0;&#x5BF9;&#x8C61;&#x3002;&#x6709;&#x4E86;&#x8FD9;&#x4E24;&#x4E2A;&#x63A5;&#x53E3;&#xFF0C;Laravel &#x7684;&#x8EAB;&#x4EFD;&#x8BA4;&#x8BC1;&#x673A;&#x5236;&#x5C31;&#x53EF;&#x4EE5;&#x4E0D;&#x7528;&#x7BA1;&#x7528;&#x6237;&#x6570;&#x636E;&#x662F;&#x5982;&#x4F55;&#x50A8;&#x5B58;&#x7684;&#x3001;&#x7A76;&#x7ADF;&#x54EA;&#x4E2A;&#x7C7B;&#x6765;&#x4EE3;&#x8868;&#x7528;&#x6237;&#x5BF9;&#x8C61;&#x8FD9;&#x79CD;&#x4E8B;&#x513F;&#xFF0C;&#x4ECE;&#x800C;&#x7EE7;&#x7EED;&#x4E13;&#x6CE8;&#x4E8E;&#x8EAB;&#x4EFD;&#x8BA4;&#x8BC1;&#x672C;&#x8EAB;&#x7684;&#x5B9E;&#x73B0;&#x3002;</p>
<p>Let&apos;s take a look at the UserProviderInterface:</p>
<p>&#x54B1;&#x4EEC;&#x6765;&#x770B;&#x4E00;&#x770B; UserProviderInterface &#x63A5;&#x53E3;&#x7684;&#x4EE3;&#x7801;&#xFF1A;</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserProviderInterface</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">retrieveById</span><span class="hljs-params">($identifier)</span></span>;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">retrieveByCredentials</span><span class="hljs-params">(array $credentials)</span></span>;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateCredentials</span><span class="hljs-params">(UserInterface $user, array $credentials)</span></span>;
}
</code></pre>
<p>The retrieveById function typically receives a numeric key representing the user, such as an auto-incrementing ID from a MySQL database. The UserInterface implementation matching the ID should be retrieved and returned by the method.</p>
<p>&#x65B9;&#x6CD5; retrieveById &#x901A;&#x5E38;&#x63A5;&#x53D7;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#x53C2;&#x6570;&#x7528;&#x6765;&#x8868;&#x793A;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#xFF0C;&#x6BD4;&#x5982; MySQL &#x6570;&#x636E;&#x5E93;&#x7684;&#x81EA;&#x589E; ID&#x3002;&#x8BE5;&#x65B9;&#x6CD5;&#x8981;&#x627E;&#x5230;&#x5339;&#x914D;&#x8BE5; ID &#x7684; UserInterface &#x7684;&#x5B9E;&#x73B0;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x4E14;&#x5C06;&#x8BE5;&#x5BF9;&#x8C61;&#x8FD4;&#x56DE;&#x3002;</p>
<p>The retrieveByCredentials method receives the array of credentials passed to the Auth::attempt method when attempting to sign into an application. The method should then &quot;query&quot; the underlying persistent storage for the user matching those credentials. Typically, this method will run a query with a &quot;where&quot; condition on $credentials[&apos;username&apos;]. This method should not attempt to do any password validation or authentication.</p>
<p>retrieveByCredentials &#x65B9;&#x6CD5;&#x63A5;&#x53D7;&#x4E00;&#x4E2A;&#x53C2;&#x6570;&#x4F5C;&#x4E3A;&#x767B;&#x5F55;&#x5E10;&#x53F7;&#x3002;&#x8BE5;&#x53C2;&#x6570;&#x662F;&#x5728;&#x5C1D;&#x8BD5;&#x767B;&#x5F55;&#x7CFB;&#x7EDF;&#x65F6;&#x4ECE; Auth::attempt &#x65B9;&#x6CD5;&#x4F20;&#x6765;&#x7684;&#x3002;&#x90A3;&#x4E48;&#x8BE5;&#x65B9;&#x6CD5;&#x5E94;&#x8BE5;&#x201C;&#x67E5;&#x8BE2;&#x201D;&#x5E95;&#x5C42;&#x7684;&#x6301;&#x4E45;&#x5316;&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;&#xFF0C;&#x6765;&#x627E;&#x5230;&#x90A3;&#x4E9B;&#x5339;&#x914D;&#x5230;&#x8BE5;&#x5E10;&#x53F7;&#x7684;&#x7528;&#x6237;&#x3002;&#x901A;&#x5E38;&#x8BE5;&#x65B9;&#x6CD5;&#x4F1A;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x5E26;&#x6709; &#x201C;where&#x201D; &#x6761;&#x4EF6;&#x7684;&#x67E5;&#x8BE2;&#x6765;&#x5339;&#x914D;&#x53C2;&#x6570;&#x91CC;&#x7684; $credentials[&apos;username&apos;]&#x3002;&#x8BE5;&#x65B9;&#x6CD5;&#x4E0D;&#x5E94;&#x8BE5;&#x505A;&#x4EFB;&#x4F55;&#x5BC6;&#x7801;&#x9A8C;&#x8BC1;&#x3002;</p>
<p>The validateCredentials method should compare the given $user with the $credentials to authenticate the user. For example, this method might compare the $user-&gt;getAuthPassword(); string to a Hash::make of $credentials[&apos;password&apos;].</p>
<p>validateCredentials &#x65B9;&#x6CD5;&#x4F1A;&#x901A;&#x8FC7;&#x6BD4;&#x8F83; $user &#x53C2;&#x6570;&#x548C; $credentials &#x53C2;&#x6570;&#x6765;&#x68C0;&#x6D4B;&#x7528;&#x6237;&#x662F;&#x5426;&#x901A;&#x8FC7;&#x8BA4;&#x8BC1;&#x3002;&#x6BD4;&#x5982;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x4F1A;&#x8C03;&#x7528; $user-&gt;getAuthPassword(); &#x65B9;&#x6CD5;&#xFF0C;&#x5C06;&#x5F97;&#x5230;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E0E; $credentials[&apos;password&apos;] &#x7ECF;&#x8FC7; Hash::make &#x5904;&#x7406;&#x540E;&#x7684;&#x7ED3;&#x679C;&#x8FDB;&#x884C;&#x6BD4;&#x5BF9;&#x3002;</p>
<p>Now that we have explored each of the methods on the UserProviderInterface, let&apos;s take a look at the UserInterface. Remember, the provider should return implementations of this interface from the retrieveById and retrieveByCredentials methods:</p>
<p>&#x73B0;&#x5728;&#x6211;&#x4EEC;&#x63A2;&#x7D22;&#x4E86; UserProviderInterface &#x63A5;&#x53E3;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x65B9;&#x6CD5;&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x54B1;&#x4EEC;&#x770B;&#x4E00;&#x770B; UserInterface &#x63A5;&#x53E3;&#x3002;&#x522B;&#x5FD8;&#x4E86; UserInterface &#x7684;&#x5B9E;&#x4F8B;&#x5E94;&#x5F53;&#x662F; retrieveById &#x548C; retrieveByCredentials &#x65B9;&#x6CD5;&#x7684;&#x8FD4;&#x56DE;&#x503C;&#xFF1A;</p>
<pre><code class="lang-php"><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserInterface</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAuthIdentifier</span><span class="hljs-params">()</span></span>;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAuthPassword</span><span class="hljs-params">()</span></span>;
}
</code></pre>
<p>This interface is simple. The getAuthIdentifier method should return the &quot;primary key&quot; of the user. In a MySQL back-end, again, this would be the auto-incrementing primary key. The getAuthPassword should return the user&apos;s hashed password. This interface allows the authentication system to work with any User class, regardless of what ORM or storage abstraction layer you are using. By default, Laravel includes a User class in the app/models directory which implements this interface, so you may consult this class for an implementation example.</p>
<p>&#x8FD9;&#x4E2A;&#x63A5;&#x53E3;&#x5F88;&#x7B80;&#x5355;&#x3002; getAuthIdentifier &#x65B9;&#x6CD5;&#x5E94;&#x5F53;&#x8FD4;&#x56DE;&#x7528;&#x6237;&#x7684;&#x201C;&#x4E3B;&#x952E;&#x201D;&#x3002;&#x5C31;&#x50CF;&#x521A;&#x624D;&#x63D0;&#x5230;&#x7684;&#xFF0C;&#x5728; MySQL &#x4E2D;&#x53EF;&#x80FD;&#x5C31;&#x662F;&#x81EA;&#x589E;&#x4E3B;&#x952E;&#x4E86;&#x3002;getAuthPassword &#x65B9;&#x6CD5;&#x5E94;&#x5F53;&#x8FD4;&#x56DE;&#x7ECF;&#x8FC7;&#x6563;&#x5217;&#x5904;&#x7406;&#x7684;&#x7528;&#x6237;&#x5BC6;&#x7801;&#x3002;&#x6709;&#x4E86;&#x8FD9;&#x4E2A;&#x63A5;&#x53E3;&#xFF0C;&#x8EAB;&#x4EFD;&#x8BA4;&#x8BC1;&#x7CFB;&#x7EDF;&#x5C31;&#x53EF;&#x4EE5;&#x4E0D;&#x7528;&#x5173;&#x5FC3;&#x7528;&#x6237;&#x7C7B;&#x5230;&#x5E95;&#x4F7F;&#x7528;&#x4E86;&#x4EC0;&#x4E48;ORM&#x6216;&#x8005;&#x4EC0;&#x4E48;&#x5B58;&#x50A8;&#x65B9;&#x5F0F;&#x3002;Laravel &#x5DF2;&#x7ECF;&#x5728; app/models &#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x5305;&#x542B;&#x4E86;&#x4E00;&#x4E2A;&#x9ED8;&#x8BA4;&#x7684; User &#x7C7B;&#x4E14;&#x5B9E;&#x73B0;&#x4E86;&#x8BE5;&#x63A5;&#x53E3;&#x3002;&#x6240;&#x4EE5;&#x4F60;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x8FD9;&#x4E2A;&#x7C7B;&#x5F53;&#x4F8B;&#x5B50;&#x3002;</p>
<p>Finally, once we have implemented the UserProviderInterface, we can ready to register our extension with the Auth facade:</p>
<p>&#x5F53;&#x6211;&#x4EEC;&#x6700;&#x540E;&#x5B9E;&#x73B0;&#x4E86; UserProviderInterface &#x63A5;&#x53E3;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5C06;&#x8BE5;&#x6269;&#x5C55;&#x6CE8;&#x518C;&#x8FDB;Auth&#x91CC;&#x9762;&#xFF1A;</p>
<pre><code class="lang-php">Auth::extend(<span class="hljs-string">&apos;riak&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($app)</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> RiakUserProvider($app[<span class="hljs-string">&apos;riak.connection&apos;</span>]);
});
</code></pre>
<p>After you have registered the driver with the extend method, you switch to the new driver in your app/config/auth.php configuration file.</p>
<p>&#x4F7F;&#x7528; extend &#x65B9;&#x6CD5;&#x6CE8;&#x518C;&#x597D;&#x9A71;&#x52A8;&#x4EE5;&#x540E;&#xFF0C;&#x4F60;&#x5C31;&#x53EF;&#x4EE5;&#x5728; app/config/auth.php &#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x91CC;&#x9762;&#x5207;&#x6362;&#x5230;&#x65B0;&#x7684;&#x9A71;&#x52A8;&#x4E86;&#x3002;</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="7.4_Session.html" class="navigation navigation-prev " aria-label="Previous page: 7.4 Session 会话">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="7.6_IoC_Based_Extension.html" class="navigation navigation-next " aria-label="Next page: 7.6 IoC Based Extension 使用容器进行扩展">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"7.5 Authentication 身份认证","level":"1.9.5","depth":2,"next":{"title":"7.6 IoC Based Extension 使用容器进行扩展","level":"1.9.6","depth":2,"path":"chapters/7.6_IoC_Based_Extension.md","ref":"./chapters/7.6_IoC_Based_Extension.md","articles":[]},"previous":{"title":"7.4 Session 会话","level":"1.9.4","depth":2,"path":"chapters/7.4_Session.md","ref":"./chapters/7.4_Session.md","articles":[]},"dir":"ltr"},"config":{"plugins":[],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"original Taylor Otwell, translate zgldh","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Laravel - 从百草园到三味书屋","language":"zh-hans","gitbook":"*"},"file":{"path":"chapters/7.5_Authentication.md","mtime":"2019-01-07T14:21:46.142Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-01-07T16:06:05.085Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

